CREATE VIEW `poi_search` AS select `pois`.`id` AS `id`,`pois`.`ctime` AS `ctime`,`pois`.`mtime` AS `mtime`,`pois`.`caption` AS `caption`,`pois`.`lat` AS `lat`,`pois`.`lon` AS `lon`,`pois`.`user_id` AS `user_id`,`pois`.`descr` AS `descr`,`pois`.`rating` AS `rating`,`pois`.`city_id` AS `city_id`,`pois`.`address` AS `address`,`pois`.`state` AS `state`,`at`.`caption` AS `key_name`, `at`.`id` AS `key_id`, `av`.`value` AS `key_value`, `av`.`code_value` AS `key_code`, `r1`.`name` AS `rubric_name`,`r2`.`name` AS `parent_rubric_name` from (((((`pois` left join `attribute_values` `av` on((`av`.`poi_id` = `pois`.`id`))) left join `attribute_types` `at` on((`at`.`id` = `av`.`attribute_type_id`))) left join `pois_rubrics` on((`pois`.`id` = `pois_rubrics`.`poi_id`))) left join `rubrics` `r1` on((`pois_rubrics`.`rubric_id` = `r1`.`id`))) left join `rubrics` `r2` on((`r1`.`rubric_id` = `r2`.`id`)));
